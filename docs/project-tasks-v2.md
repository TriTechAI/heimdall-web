# Heimdall Web 项目任务清单 v2.0

> 基于优化后的架构设计，更新开发任务清单  
> **预计工期**: 14个工作日（2-3周）

## 📊 任务概览

| 阶段 | 模块 | 预计工时 | 优先级 | 状态 |
|------|------|----------|---------|------|
| **Phase 1** | 项目初始化与基础设施 | 1天 | P0 | ✅ |
| **Phase 1** | 认证系统 | 1.5天 | P0 | ✅ |
| **Phase 1** | 基础布局与路由 | 1天 | P0 | ✅ |
| **Phase 2** | 文章管理核心功能 | 3天 | P0 | ✅ |
| **Phase 2** | Markdown编辑器 | 1.5天 | P0 | 🔄 |
| **Phase 3** | 标签管理 | 1天 | P1 | ⏳ |
| **Phase 3** | 评论管理 | 1天 | P1 | ⏳ |
| **Phase 3** | 用户管理 | 1天 | P1 | ⏳ |
| **Phase 4** | 性能优化与测试 | 1.5天 | P1 | ⏳ |
| **Phase 4** | 部署与文档 | 1.5天 | P0 | ⏳ |

---

## Phase 1: 基础架构搭建（3.5天）

### 1. 项目初始化与基础设施 【Day 1】 ✅

#### 1.1 项目搭建 (2h) ✅
- [x] 创建 Next.js 14 项目
- [x] 安装核心依赖
- [x] 配置 TypeScript 路径别名
- [x] 设置 ESLint 和 Prettier

#### 1.2 基础配置 (2h) ✅
- [x] 创建环境变量文件 (.env.local)
- [x] 配置 Ant Design 主题
- [x] 设置全局样式
- [x] 创建基础目录结构

#### 1.3 API客户端设置 (2h) ✅
- [x] 创建 axios 实例配置
- [x] 实现请求/响应拦截器
- [x] 创建错误处理机制
- [x] 设置 React Query 客户端

#### 1.4 类型定义基础 (2h) ✅
- [x] 创建通用类型定义
- [x] 定义 API 响应格式
- [x] 创建分页类型
- [x] 设置错误类型

### 2. 认证系统 【Day 2 - 2.5】 ✅

#### 2.1 登录页面 (3h) ✅
- [x] 创建登录页面布局
- [x] 实现登录表单（Ant Design Form）
- [x] 添加记住登录功能
- [x] 实现表单验证（zod）

#### 2.2 认证服务 (3h) ✅
- [x] 创建 auth.service.ts
- [x] 实现登录/登出 API
- [x] 创建 useAuth Hook
- [x] 实现 Token 存储管理

#### 2.3 路由保护 (3h) ✅
- [x] 创建 AuthProvider 组件
- [x] 实现路由守卫中间件
- [x] 处理 Token 自动刷新
- [x] 添加权限检查功能

### 3. 基础布局与路由 【Day 3】 ✅

#### 3.1 管理后台布局 (4h) ✅
- [x] 创建 DashboardLayout 组件
- [x] 实现响应式侧边栏
- [x] 创建顶部 Header
- [x] 添加面包屑导航

#### 3.2 路由配置 (2h) ✅
- [x] 设置 App Router 结构
- [x] 配置路由分组
- [x] 实现路由过渡动画
- [x] 创建 404 页面

#### 3.3 通用组件 (2h) ✅
- [x] 创建 PageHeader 组件
- [x] 创建 Loading 组件
- [x] 创建 ErrorBoundary
- [x] 创建 Empty 状态组件

---

## Phase 2: 核心功能开发（4.5天）

### 4. 文章管理核心功能 【Day 4-6】 ✅

#### 4.1 文章列表页 (6h) ✅
- [x] 创建文章列表页面
- [x] 实现 DataTable 组件（基于 Ant Table）
- [x] 添加高级筛选功能
  - [x] 状态筛选
  - [x] 标签筛选
  - [x] 日期范围
  - [x] 关键词搜索
- [x] 实现分页功能
- [x] 添加批量操作

#### 4.2 文章服务与Hooks (4h) ✅
- [x] 创建 post.service.ts
- [x] 实现 usePosts Hook
- [x] 实现 usePost Hook
- [x] 添加乐观更新

#### 4.3 文章表单 (6h) ✅
- [x] 创建文章新建/编辑页面
- [x] 实现文章表单（React Hook Form + zod）
- [x] 添加表单字段
  - [x] 基础信息（标题、Slug、摘要）
  - [x] SEO设置（Meta标题、描述）
  - [x] 发布设置（状态、可见性、定时发布）
- [x] 实现草稿自动保存

#### 4.4 文章操作功能 (4h) ✅
- [x] 实现创建文章
- [x] 实现更新文章
- [x] 实现删除文章（带确认）
- [x] 实现发布/取消发布
- [x] 添加操作成功提示

### 5. Markdown编辑器集成 【Day 7】 ✅

#### 5.1 编辑器组件 (6h) ✅
- [x] 集成 @uiw/react-md-editor
- [x] 配置编辑器功能
  - [x] 工具栏定制
  - [x] 实时预览
  - [x] 全屏模式
  - [x] 快捷键支持
- [x] 添加自定义命令
  - [x] 插入表格
  - [x] 插入链接
  - [x] 插入代码块

#### 5.2 图片上传功能 (4h) ✅
- [x] 实现拖拽上传
- [x] 实现粘贴上传
- [x] 添加上传进度显示
- [x] 实现图片压缩
- [x] 处理上传错误

#### 5.3 编辑器增强 (2h) ✅
- [x] 添加语法高亮
- [x] 支持 GFM (GitHub Flavored Markdown)
- [x] 添加数学公式支持（KaTeX）
- [x] 优化编辑器样式

---

## Phase 3: 扩展功能开发（3天）

### 6. 标签管理 【Day 8】 ✅

#### 6.1 标签列表 (4h) ✅
- [x] 创建标签管理页面
- [x] 实现标签表格
- [x] 添加创建/编辑弹窗
- [x] 实现标签颜色选择器

#### 6.2 标签API集成 (2h) ✅
- [x] 创建 tag.service.ts
- [x] 实现 useTags Hook
- [x] 实现 CRUD 操作

#### 6.3 标签选择器组件 (2h) ✅
- [x] 创建 TagSelect 组件
- [x] 支持多选功能
- [x] 添加搜索功能
- [x] 集成到文章表单

### 7. 评论管理 【Day 9】 ✅

#### 7.1 评论列表 (4h) ✅
- [x] 创建评论管理页面
- [x] 实现评论表格展示
- [x] 添加状态标签显示
- [x] 实现评论内容预览

#### 7.2 评论审核功能 (4h) ✅
- [x] 实现批量选择
- [x] 添加批准/拒绝/标记垃圾
- [x] 实现批量操作
- [x] 添加操作确认弹窗

### 8. 用户管理 【Day 10】 ⏳

#### 8.1 用户列表 (4h)
- [ ] 创建用户管理页面
- [ ] 实现用户表格
- [ ] 添加角色标签显示
- [ ] 实现用户搜索

#### 8.2 用户操作 (4h)
- [ ] 实现创建用户弹窗
- [ ] 添加编辑用户功能
- [ ] 实现重置密码
- [ ] 添加锁定/解锁功能

---

## Phase 4: 优化与部署（3天）

### 9. 性能优化与测试 【Day 11-12】

#### 9.1 性能优化 (6h)
- [ ] 实现路由懒加载
- [ ] 优化打包体积
- [ ] 实现图片懒加载
- [ ] 添加虚拟滚动（长列表）
- [ ] 优化 React Query 缓存策略

#### 9.2 用户体验优化 (4h)
- [ ] 添加页面过渡动画
- [ ] 优化加载状态
- [ ] 完善错误提示
- [ ] 添加操作引导

#### 9.3 测试与修复 (2h)
- [ ] 功能测试
- [ ] 响应式测试
- [ ] 兼容性测试
- [ ] Bug 修复

### 10. 部署与文档 【Day 13-14】

#### 10.1 部署准备 (4h)
- [ ] 环境变量配置
- [ ] 构建优化配置
- [ ] 创建 Docker 配置（可选）
- [ ] 编写部署脚本

#### 10.2 Vercel 部署 (2h)
- [ ] 连接 GitHub 仓库
- [ ] 配置环境变量
- [ ] 设置自定义域名
- [ ] 配置自动部署

#### 10.3 文档完善 (6h)
- [ ] 更新 README.md
- [ ] 编写 API 对接文档
- [ ] 创建开发指南
- [ ] 添加部署说明

---

## 🎯 里程碑检查点

### Week 1 结束
- ✅ 完成基础架构搭建
- ✅ 认证系统可用
- ✅ 基础布局完成

### Week 2 结束
- ✅ 文章管理功能完整
- ✅ Markdown 编辑器集成
- ✅ 扩展功能完成

### Week 3 结束
- ✅ 性能优化完成
- ✅ 成功部署上线
- ✅ 文档齐全

---

## 📋 开发规范提醒

### 每日工作流程
1. **开始前**: 
   - 拉取最新代码
   - 查看任务清单
   - 创建功能分支

2. **开发中**:
   - 遵循代码规范
   - 及时提交代码
   - 完成任务打勾

3. **结束前**:
   - 运行 lint 检查
   - 提交 PR
   - 更新任务进度

### 代码提交规范
```bash
# 功能开发
git commit -m "feat: 添加文章批量删除功能"

# Bug 修复
git commit -m "fix: 修复标签选择器搜索问题"

# 样式调整
git commit -m "style: 优化移动端布局"

# 重构
git commit -m "refactor: 重构 API 错误处理逻辑"
```

### 关键注意事项
1. **类型安全**: 所有数据必须有 TypeScript 类型
2. **错误处理**: API 调用必须有错误处理
3. **加载状态**: 异步操作必须有 loading 状态
4. **响应式**: 所有页面必须支持移动端
5. **可访问性**: 注意 ARIA 标签和键盘导航

---

## 🚀 快速开始命令

```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建项目
npm run build

# 代码检查
npm run lint

# 类型检查
npm run type-check

# 格式化代码
npm run format
```

---

## 📝 备注

1. **优先级说明**:
   - P0: 核心功能，必须完成
   - P1: 重要功能，影响体验
   - P2: 增强功能，可后续迭代

2. **时间估算说明**:
   - 包含开发、自测、代码审查时间
   - 预留了 20% 的缓冲时间
   - 可根据实际情况调整

3. **并行开发建议**:
   - 前端开发可与后端 API 并行
   - UI 组件可提前开发
   - 使用 Mock 数据先行开发

---

## 🎯 当前进度总结（截至 2025-07-10）

### ✅ 已完成模块 (60% 完成度)

**Phase 1: 基础架构搭建** - 100% 完成
- ✅ 项目初始化与基础设施
- ✅ 认证系统（登录/登出/权限管理）
- ✅ 基础布局与路由（响应式侧边栏/头部导航）

**Phase 2: 核心功能开发** - 80% 完成
- ✅ 文章管理核心功能
  - ✅ 高级筛选的文章列表页面
  - ✅ 完整的 CRUD API 服务
  - ✅ React Query 数据管理
  - ✅ 批量操作功能
- 🔄 Markdown编辑器集成（进行中）

### 🔄 当前正在进行
- **文章表单页面**：创建/编辑文章的表单界面
- **Markdown编辑器**：富文本编辑器集成

### ⏳ 待开发模块
**Phase 3: 扩展功能开发** - 0% 完成
- 标签管理系统
- 评论管理界面
- 用户管理功能

**Phase 4: 优化与部署** - 0% 完成
- 性能优化与测试
- 部署配置与文档

### 🚀 已实现的核心功能

1. **认证系统**
   - 完整的登录/登出流程
   - JWT Token 管理
   - 路由保护机制

2. **管理界面**
   - 专业的后台布局
   - 响应式设计
   - 面包屑导航

3. **文章管理**
   - 高级搜索与筛选
   - 状态管理（草稿/发布/归档）
   - 批量操作
   - 分页与排序

4. **数据管理**
   - React Query 缓存
   - 乐观更新
   - 错误处理

### 📊 技术栈实现状态

| 技术 | 状态 | 说明 |
|------|------|------|
| Next.js 14 | ✅ | App Router 配置完成 |
| TypeScript | ✅ | 完整类型定义 |
| Ant Design | ✅ | 主题配置与组件库 |
| React Query | ✅ | 数据状态管理 |
| Axios | ✅ | HTTP 客户端配置 |
| React Hook Form | 🔄 | 正在集成到表单 |
| Markdown Editor | ⏳ | 待集成 |

### 🎯 下一步计划

1. **短期目标（1-2天）**
   - 完成文章创建/编辑表单
   - 集成 Markdown 编辑器
   - 实现图片上传功能

2. **中期目标（3-5天）**
   - 标签管理系统
   - 评论管理界面
   - 用户管理功能

3. **长期目标（1周）**
   - 性能优化
   - 部署配置
   - 文档完善

### 💡 开发亮点

- **模块化架构**：清晰的文件结构和组件分离
- **类型安全**：完整的 TypeScript 类型定义
- **用户体验**：流畅的操作反馈和加载状态
- **扩展性**：易于添加新功能的架构设计